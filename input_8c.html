<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UEFIStarter: apps/input.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UEFIStarter
   </div>
   <div id="projectbrief">a simple UEFI framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_9654b8d08f4bba4e84b362c5fd320bee.html">apps</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">input.c File Reference<div class="ingroups"><a class="el" href="group__group__apps.html">Applications</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>This application showcases ways to read input from the keyboard.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;Uefi.h&gt;</code><br />
<code>#include &lt;Library/UefiLib.h&gt;</code><br />
<code>#include &lt;Library/UefiBootServicesTableLib.h&gt;</code><br />
<code>#include &quot;<a class="el" href="console_8h_source.html">../include/console.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cmdline_8h_source.html">../include/cmdline.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="logger_8h_source.html">../include/logger.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a48d1e0ff535e0ced1b100310ae8f07b2"><td class="memItemLeft" align="right" valign="top"><a id="a48d1e0ff535e0ced1b100310ae8f07b2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_8c.html#a48d1e0ff535e0ced1b100310ae8f07b2">ARG_HANDLE</a>&#160;&#160;&#160;<a class="el" href="lspci_8c.html#aba60c4f0d7f55179e5c48d5d056615e8">_args</a>[0].value.uint64</td></tr>
<tr class="memdesc:a48d1e0ff535e0ced1b100310ae8f07b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">helper macro to access the "handle offset" command-line argument's value <br /></td></tr>
<tr class="separator:a48d1e0ff535e0ced1b100310ae8f07b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5af04a4cccebe6cc4ac1514cf9e05dd7"><td class="memItemLeft" align="right" valign="top"><a id="a5af04a4cccebe6cc4ac1514cf9e05dd7"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_8c.html#a5af04a4cccebe6cc4ac1514cf9e05dd7">ARG_OTHER_WAIT_EVENT</a>&#160;&#160;&#160;<a class="el" href="lspci_8c.html#aba60c4f0d7f55179e5c48d5d056615e8">_args</a>[1].value.uint64</td></tr>
<tr class="memdesc:a5af04a4cccebe6cc4ac1514cf9e05dd7"><td class="mdescLeft">&#160;</td><td class="mdescRight">helper macro to access the alternative wait command-line argument's value <br /></td></tr>
<tr class="separator:a5af04a4cccebe6cc4ac1514cf9e05dd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aebdf93f53d1d1c78101972809e164746"><td class="memItemLeft" align="right" valign="top"><a id="aebdf93f53d1d1c78101972809e164746"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_8c.html#aebdf93f53d1d1c78101972809e164746">test_simple_input</a> ()</td></tr>
<tr class="memdesc:aebdf93f53d1d1c78101972809e164746"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads keyboard input the easiest way: SIMPLE_TEXT_INPUT_PROTOCOL. <br /></td></tr>
<tr class="separator:aebdf93f53d1d1c78101972809e164746"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a960225c5465570e06a91c01f67dbb0eb"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_8c.html#a960225c5465570e06a91c01f67dbb0eb">find_device</a> (EFI_GUID *guid, unsigned int offset)</td></tr>
<tr class="memdesc:a960225c5465570e06a91c01f67dbb0eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Locates an UEFI protocol handler, opens and returns it.  <a href="#a960225c5465570e06a91c01f67dbb0eb">More...</a><br /></td></tr>
<tr class="separator:a960225c5465570e06a91c01f67dbb0eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a908961912faaa3d7516915fb3bd7f3ba"><td class="memItemLeft" align="right" valign="top">EFI_SIMPLE_TEXT_INPUT_EX_PROTOCOL *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_8c.html#a908961912faaa3d7516915fb3bd7f3ba">find_input_ex</a> ()</td></tr>
<tr class="memdesc:a908961912faaa3d7516915fb3bd7f3ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the protocol handler for SIMPLE_TEXT_INPUT_EX_PROTOCOL.  <a href="#a908961912faaa3d7516915fb3bd7f3ba">More...</a><br /></td></tr>
<tr class="separator:a908961912faaa3d7516915fb3bd7f3ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4e72bb3427cd6befd7ba2e9484e021a"><td class="memItemLeft" align="right" valign="top"><a id="ae4e72bb3427cd6befd7ba2e9484e021a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_8c.html#ae4e72bb3427cd6befd7ba2e9484e021a">test_ex_input</a> ()</td></tr>
<tr class="memdesc:ae4e72bb3427cd6befd7ba2e9484e021a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads keyboard input with the extended protocol: SIMPLE_TEXT_INPUT_EX_PROTOCOL. <br /></td></tr>
<tr class="separator:ae4e72bb3427cd6befd7ba2e9484e021a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeb724dad954b4ec0cf31b22e2eb037a"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_8c.html#afeb724dad954b4ec0cf31b22e2eb037a">ex_notify</a> (EFI_KEY_DATA *data)</td></tr>
<tr class="memdesc:afeb724dad954b4ec0cf31b22e2eb037a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function for keyboard handler, prints the pressed key(s).  <a href="#afeb724dad954b4ec0cf31b22e2eb037a">More...</a><br /></td></tr>
<tr class="separator:afeb724dad954b4ec0cf31b22e2eb037a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61b268e16837d3fc9950808bf21c00be"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_8c.html#a61b268e16837d3fc9950808bf21c00be">test_ex_notify</a> ()</td></tr>
<tr class="memdesc:a61b268e16837d3fc9950808bf21c00be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a listener for a specific key combination and waits for that combination to be pressed.  <a href="#a61b268e16837d3fc9950808bf21c00be">More...</a><br /></td></tr>
<tr class="separator:a61b268e16837d3fc9950808bf21c00be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab78f8f08204072124ace7317c3b9728e"><td class="memItemLeft" align="right" valign="top">INTN EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_8c.html#ab78f8f08204072124ace7317c3b9728e">ShellAppMain</a> (UINTN argc, CHAR16 **argv)</td></tr>
<tr class="memdesc:ab78f8f08204072124ace7317c3b9728e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main function, gets invoked by UEFI shell.  <a href="#ab78f8f08204072124ace7317c3b9728e">More...</a><br /></td></tr>
<tr class="separator:ab78f8f08204072124ace7317c3b9728e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aba60c4f0d7f55179e5c48d5d056615e8"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structcmdline__argument__t.html">cmdline_argument_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_8c.html#aba60c4f0d7f55179e5c48d5d056615e8">_args</a> []</td></tr>
<tr class="memdesc:aba60c4f0d7f55179e5c48d5d056615e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">command-line arguments  <a href="#aba60c4f0d7f55179e5c48d5d056615e8">More...</a><br /></td></tr>
<tr class="separator:aba60c4f0d7f55179e5c48d5d056615e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cce9f8b526c2942e7541defc2bdd040"><td class="memItemLeft" align="right" valign="top"><a id="a8cce9f8b526c2942e7541defc2bdd040"></a>
static <a class="el" href="structcmdline__argument__group__t.html">cmdline_argument_group_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="input_8c.html#a8cce9f8b526c2942e7541defc2bdd040">_arguments</a> ={ L&quot;Application-specific options&quot; ,sizeof( <a class="el" href="lspci_8c.html#aba60c4f0d7f55179e5c48d5d056615e8">_args</a> )/sizeof(<a class="el" href="structcmdline__argument__t.html">cmdline_argument_t</a>), <a class="el" href="lspci_8c.html#aba60c4f0d7f55179e5c48d5d056615e8">_args</a> }</td></tr>
<tr class="memdesc:a8cce9f8b526c2942e7541defc2bdd040"><td class="mdescLeft">&#160;</td><td class="mdescRight">command-line argument group <br /></td></tr>
<tr class="separator:a8cce9f8b526c2942e7541defc2bdd040"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This application showcases ways to read input from the keyboard. </p>
<p>Keep in mind that terminals (and terminal multiplexers) in virtualized environments often don't send the pressed keys' raw scancodes but escape sequences instead. For example you may have to hit the Escape key 2-3 times in succession until it's registered once.</p>
<dl class="section author"><dt>Author</dt><dd>Richard Nusser </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>2017-2018 Richard Nusser </dd></dl>
<dl class="section user"><dt>License</dt><dd>GPLv3 (see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>) </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://github.com/rinusser/UEFIStarter">https://github.com/rinusser/UEFIStarter</a> </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a960225c5465570e06a91c01f67dbb0eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a960225c5465570e06a91c01f67dbb0eb">&#9670;&nbsp;</a></span>find_device()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* find_device </td>
          <td>(</td>
          <td class="paramtype">EFI_GUID *&#160;</td>
          <td class="paramname"><em>guid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Locates an UEFI protocol handler, opens and returns it. </p>
<p>UEFI protocols can have multiple handlers attached, use the (0-based) "offset" parameter to determine which handler you want. Usually the handler at offset 0 works fine.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">guid</td><td>the protocol GUID to locate </td></tr>
    <tr><td class="paramname">offset</td><td>makes this function return the (0-based) nth handler for the requested protocol </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the protoco handler's address, or NULL on error</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd>extract to lib and rename to open_protocol() </dd></dl>

</div>
</div>
<a id="a908961912faaa3d7516915fb3bd7f3ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a908961912faaa3d7516915fb3bd7f3ba">&#9670;&nbsp;</a></span>find_input_ex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_SIMPLE_TEXT_INPUT_EX_PROTOCOL* find_input_ex </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the protocol handler for SIMPLE_TEXT_INPUT_EX_PROTOCOL. </p>
<dl class="section return"><dt>Returns</dt><dd>the handler's address, or NULL on error </dd></dl>

</div>
</div>
<a id="afeb724dad954b4ec0cf31b22e2eb037a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeb724dad954b4ec0cf31b22e2eb037a">&#9670;&nbsp;</a></span>ex_notify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI ex_notify </td>
          <td>(</td>
          <td class="paramtype">EFI_KEY_DATA *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback function for keyboard handler, prints the pressed key(s). </p>
<p>This function gets called on individually registered keystrrokes only.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>the pressed keys' data </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the EFI status code, currently always indicating success </dd></dl>

</div>
</div>
<a id="a61b268e16837d3fc9950808bf21c00be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61b268e16837d3fc9950808bf21c00be">&#9670;&nbsp;</a></span>test_ex_notify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test_ex_notify </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a listener for a specific key combination and waits for that combination to be pressed. </p>
<p>There are no wildcards allowing to register multiple keys at once and left/right modifier states (e.g. "left shift" vs. "right shift") have to be registered separately. An application needs to register, remember and then unregister handlers for each combination of keys, so this way of reading the keyboard is probably too cumbersome for large amounts of key combinations. </p>

</div>
</div>
<a id="ab78f8f08204072124ace7317c3b9728e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab78f8f08204072124ace7317c3b9728e">&#9670;&nbsp;</a></span>ShellAppMain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INTN EFIAPI ShellAppMain </td>
          <td>(</td>
          <td class="paramtype">UINTN&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CHAR16 **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main function, gets invoked by UEFI shell. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">argc</td><td>the number of command-line arguments passed </td></tr>
    <tr><td class="paramname">argv</td><td>the command-line arguments passed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>an EFI status code for the shell </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aba60c4f0d7f55179e5c48d5d056615e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba60c4f0d7f55179e5c48d5d056615e8">&#9670;&nbsp;</a></span>_args</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcmdline__argument__t.html">cmdline_argument_t</a> _args[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">  {{uint64:0},<a class="code" href="cmdline_8h.html#a3ba763fb77eb06a8628d013e1aff8058a58393752406d163205fa18f450909993">ARG_INT</a>, NULL,L<span class="stringliteral">&quot;-handle&quot;</span>,          L<span class="stringliteral">&quot;Use (zero-based) nth handle&quot;</span>},</div><div class="line">  {{uint64:0},<a class="code" href="cmdline_8h.html#a3ba763fb77eb06a8628d013e1aff8058abf7a62aa02218bffcdea72b3cb36ac0d">ARG_BOOL</a>,NULL,L<span class="stringliteral">&quot;-other-wait-event&quot;</span>,L<span class="stringliteral">&quot;Use alternate wait event&quot;</span>},</div><div class="line">}</div><div class="ttc" id="cmdline_8h_html_a3ba763fb77eb06a8628d013e1aff8058abf7a62aa02218bffcdea72b3cb36ac0d"><div class="ttname"><a href="cmdline_8h.html#a3ba763fb77eb06a8628d013e1aff8058abf7a62aa02218bffcdea72b3cb36ac0d">ARG_BOOL</a></div><div class="ttdoc">boolean </div><div class="ttdef"><b>Definition:</b> cmdline.h:22</div></div>
<div class="ttc" id="cmdline_8h_html_a3ba763fb77eb06a8628d013e1aff8058a58393752406d163205fa18f450909993"><div class="ttname"><a href="cmdline_8h.html#a3ba763fb77eb06a8628d013e1aff8058a58393752406d163205fa18f450909993">ARG_INT</a></div><div class="ttdoc">integer </div><div class="ttdef"><b>Definition:</b> cmdline.h:23</div></div>
</div><!-- fragment -->
<p>command-line arguments </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jan 25 2018 21:30:14 for UEFIStarter by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
